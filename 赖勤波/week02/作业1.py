"""



只有一层隐藏层  隐藏层通道数为128
Batch 个数 0, 当前Batch Loss: 2.503202438354492
Batch 个数 50, 当前Batch Loss: 2.48036789894104
Batch 个数 100, 当前Batch Loss: 2.4687631130218506
Batch 个数 150, 当前Batch Loss: 2.4325954914093018
Batch 个数 200, 当前Batch Loss: 2.4537813663482666
Batch 个数 250, 当前Batch Loss: 2.408034563064575
Batch 个数 300, 当前Batch Loss: 2.3872668743133545
Batch 个数 350, 当前Batch Loss: 2.3324100971221924
Epoch [1/10], Loss: 2.4253
Batch 个数 0, 当前Batch Loss: 2.3117265701293945
Batch 个数 50, 当前Batch Loss: 2.328946590423584
Batch 个数 100, 当前Batch Loss: 2.2553036212921143
Batch 个数 150, 当前Batch Loss: 2.2297308444976807
Batch 个数 200, 当前Batch Loss: 2.2413952350616455
Batch 个数 250, 当前Batch Loss: 2.193129062652588
Batch 个数 300, 当前Batch Loss: 2.178786516189575
Batch 个数 350, 当前Batch Loss: 2.1168270111083984
Epoch [2/10], Loss: 2.2252
Batch 个数 0, 当前Batch Loss: 2.054672956466675
Batch 个数 50, 当前Batch Loss: 2.0928266048431396
Batch 个数 100, 当前Batch Loss: 1.9421480894088745
Batch 个数 150, 当前Batch Loss: 1.9094218015670776
Batch 个数 200, 当前Batch Loss: 2.0558435916900635
Batch 个数 250, 当前Batch Loss: 1.8092882633209229
Batch 个数 300, 当前Batch Loss: 1.8440171480178833
Batch 个数 350, 当前Batch Loss: 1.8690283298492432
Epoch [3/10], Loss: 1.9148
Batch 个数 0, 当前Batch Loss: 1.9307341575622559
Batch 个数 50, 当前Batch Loss: 1.6805825233459473
Batch 个数 100, 当前Batch Loss: 1.970528244972229
Batch 个数 150, 当前Batch Loss: 1.71835458278656
Batch 个数 200, 当前Batch Loss: 1.693910837173462
Batch 个数 250, 当前Batch Loss: 1.5244663953781128
Batch 个数 300, 当前Batch Loss: 1.6782785654067993
Batch 个数 350, 当前Batch Loss: 1.420669436454773
Epoch [4/10], Loss: 1.5321
Batch 个数 0, 当前Batch Loss: 1.3998602628707886
Batch 个数 50, 当前Batch Loss: 1.2480705976486206
Batch 个数 100, 当前Batch Loss: 1.307175874710083
Batch 个数 150, 当前Batch Loss: 1.1286892890930176
Batch 个数 200, 当前Batch Loss: 1.6137371063232422
Batch 个数 250, 当前Batch Loss: 1.004119634628296
Batch 个数 300, 当前Batch Loss: 1.0950181484222412
Batch 个数 350, 当前Batch Loss: 0.9644454717636108
Epoch [5/10], Loss: 1.2011
Batch 个数 0, 当前Batch Loss: 0.810824990272522
Batch 个数 50, 当前Batch Loss: 0.9599326252937317
Batch 个数 100, 当前Batch Loss: 0.9339548945426941
Batch 个数 150, 当前Batch Loss: 0.9183919429779053
Batch 个数 200, 当前Batch Loss: 0.8291422724723816
Batch 个数 250, 当前Batch Loss: 0.999638557434082
Batch 个数 300, 当前Batch Loss: 1.1248968839645386
Batch 个数 350, 当前Batch Loss: 1.009057641029358
Epoch [6/10], Loss: 0.9700
Batch 个数 0, 当前Batch Loss: 0.8318532109260559
Batch 个数 50, 当前Batch Loss: 1.0998504161834717
Batch 个数 100, 当前Batch Loss: 1.0907483100891113
Batch 个数 150, 当前Batch Loss: 0.7489912509918213
Batch 个数 200, 当前Batch Loss: 0.9503011107444763
Batch 个数 250, 当前Batch Loss: 0.8574823141098022
Batch 个数 300, 当前Batch Loss: 0.7026898860931396
Batch 个数 350, 当前Batch Loss: 0.7117799520492554
Epoch [7/10], Loss: 0.8189
Batch 个数 0, 当前Batch Loss: 0.7077000141143799
Batch 个数 50, 当前Batch Loss: 0.8721579313278198
Batch 个数 100, 当前Batch Loss: 0.6332330703735352
Batch 个数 150, 当前Batch Loss: 0.6497732996940613
Batch 个数 200, 当前Batch Loss: 0.6328388452529907
Batch 个数 250, 当前Batch Loss: 0.5941978693008423
Batch 个数 300, 当前Batch Loss: 0.6702816486358643
Batch 个数 350, 当前Batch Loss: 0.8264778852462769
Epoch [8/10], Loss: 0.7158
Batch 个数 0, 当前Batch Loss: 0.6680976152420044
Batch 个数 50, 当前Batch Loss: 0.6616689562797546
Batch 个数 100, 当前Batch Loss: 0.7259125113487244
Batch 个数 150, 当前Batch Loss: 0.6183582544326782
Batch 个数 200, 当前Batch Loss: 0.8198601603507996
Batch 个数 250, 当前Batch Loss: 0.7466094493865967
Batch 个数 300, 当前Batch Loss: 0.49614962935447693
Batch 个数 350, 当前Batch Loss: 0.799405038356781
Epoch [9/10], Loss: 0.6428
Batch 个数 0, 当前Batch Loss: 0.5298606753349304
Batch 个数 50, 当前Batch Loss: 0.48840320110321045
Batch 个数 100, 当前Batch Loss: 0.7096171975135803
Batch 个数 150, 当前Batch Loss: 0.5967547297477722
Batch 个数 200, 当前Batch Loss: 0.7740676999092102
Batch 个数 250, 当前Batch Loss: 0.7005262970924377
Batch 个数 300, 当前Batch Loss: 0.490495502948761
Batch 个数 350, 当前Batch Loss: 0.7056918144226074
Epoch [10/10], Loss: 0.5849
输入 '帮我导航到北京' 预测为: 'Travel-Query'
输入 '查询明天北京的天气' 预测为: 'Weather-Query'

有3个隐藏层loss收敛情况  隐藏层通道数为128,128,128
Batch 个数 0, 当前Batch Loss: 2.4893009662628174
Batch 个数 50, 当前Batch Loss: 2.4766390323638916
Batch 个数 100, 当前Batch Loss: 2.4672694206237793
Batch 个数 150, 当前Batch Loss: 2.4580230712890625
Batch 个数 200, 当前Batch Loss: 2.4482834339141846
Batch 个数 250, 当前Batch Loss: 2.4466514587402344
Batch 个数 300, 当前Batch Loss: 2.4259729385375977
Batch 个数 350, 当前Batch Loss: 2.425994873046875
Epoch [1/50], Loss: 2.4490
Batch 个数 0, 当前Batch Loss: 2.425931215286255
Batch 个数 50, 当前Batch Loss: 2.4198896884918213
Batch 个数 100, 当前Batch Loss: 2.417206287384033
Batch 个数 150, 当前Batch Loss: 2.4092535972595215
Batch 个数 200, 当前Batch Loss: 2.385796070098877
Batch 个数 250, 当前Batch Loss: 2.3710427284240723
Batch 个数 300, 当前Batch Loss: 2.4113268852233887
Batch 个数 350, 当前Batch Loss: 2.3758022785186768
Epoch [2/50], Loss: 2.4015
Batch 个数 0, 当前Batch Loss: 2.390321969985962
Batch 个数 50, 当前Batch Loss: 2.4305002689361572
Batch 个数 100, 当前Batch Loss: 2.3966400623321533
Batch 个数 150, 当前Batch Loss: 2.3278443813323975
Batch 个数 200, 当前Batch Loss: 2.364513874053955
Batch 个数 250, 当前Batch Loss: 2.3076939582824707
Batch 个数 300, 当前Batch Loss: 2.379882574081421
Batch 个数 350, 当前Batch Loss: 2.462315559387207
Epoch [3/50], Loss: 2.3737
Batch 个数 0, 当前Batch Loss: 2.38737154006958
Batch 个数 50, 当前Batch Loss: 2.329899549484253
Batch 个数 100, 当前Batch Loss: 2.324883222579956
Batch 个数 150, 当前Batch Loss: 2.4081499576568604
Batch 个数 200, 当前Batch Loss: 2.322056770324707
Batch 个数 250, 当前Batch Loss: 2.3246569633483887
Batch 个数 300, 当前Batch Loss: 2.2698333263397217
Batch 个数 350, 当前Batch Loss: 2.317301034927368
Epoch [4/50], Loss: 2.3552
Batch 个数 0, 当前Batch Loss: 2.3489503860473633
Batch 个数 50, 当前Batch Loss: 2.393413782119751
Batch 个数 100, 当前Batch Loss: 2.3180124759674072
Batch 个数 150, 当前Batch Loss: 2.2695860862731934
Batch 个数 200, 当前Batch Loss: 2.3396644592285156
Batch 个数 250, 当前Batch Loss: 2.296060800552368
Batch 个数 300, 当前Batch Loss: 2.43620228767395
Batch 个数 350, 当前Batch Loss: 2.380192518234253
Epoch [5/50], Loss: 2.3395
Batch 个数 0, 当前Batch Loss: 2.393425703048706
Batch 个数 50, 当前Batch Loss: 2.3420751094818115
Batch 个数 100, 当前Batch Loss: 2.243969440460205
Batch 个数 150, 当前Batch Loss: 2.4204275608062744
Batch 个数 200, 当前Batch Loss: 2.2763853073120117
Batch 个数 250, 当前Batch Loss: 2.3313965797424316
Batch 个数 300, 当前Batch Loss: 2.460646152496338
Batch 个数 350, 当前Batch Loss: 2.3073270320892334
Epoch [6/50], Loss: 2.3179
Batch 个数 0, 当前Batch Loss: 2.4349746704101562
Batch 个数 50, 当前Batch Loss: 2.2967092990875244
Batch 个数 100, 当前Batch Loss: 2.3576433658599854
Batch 个数 150, 当前Batch Loss: 2.2772836685180664
Batch 个数 200, 当前Batch Loss: 2.205169200897217
Batch 个数 250, 当前Batch Loss: 2.2486572265625
Batch 个数 300, 当前Batch Loss: 2.3032572269439697
Batch 个数 350, 当前Batch Loss: 2.206892490386963
Epoch [7/50], Loss: 2.2617
Batch 个数 0, 当前Batch Loss: 2.166219711303711
Batch 个数 50, 当前Batch Loss: 2.291637659072876
Batch 个数 100, 当前Batch Loss: 2.1521189212799072
Batch 个数 150, 当前Batch Loss: 2.105922222137451
Batch 个数 200, 当前Batch Loss: 2.1694750785827637
Batch 个数 250, 当前Batch Loss: 2.0462183952331543
Batch 个数 300, 当前Batch Loss: 2.179926872253418
Batch 个数 350, 当前Batch Loss: 1.8945324420928955
Epoch [8/50], Loss: 2.0936
Batch 个数 0, 当前Batch Loss: 2.0688889026641846
Batch 个数 50, 当前Batch Loss: 1.928131341934204
Batch 个数 100, 当前Batch Loss: 1.7674750089645386
Batch 个数 150, 当前Batch Loss: 1.8236277103424072
Batch 个数 200, 当前Batch Loss: 1.6959969997406006
Batch 个数 250, 当前Batch Loss: 1.8663387298583984
Batch 个数 300, 当前Batch Loss: 1.8163633346557617
Batch 个数 350, 当前Batch Loss: 1.891150951385498
Epoch [9/50], Loss: 1.8245
Batch 个数 0, 当前Batch Loss: 1.8988703489303589
Batch 个数 50, 当前Batch Loss: 1.5202076435089111
Batch 个数 100, 当前Batch Loss: 1.6850663423538208
Batch 个数 150, 当前Batch Loss: 1.6004993915557861
Batch 个数 200, 当前Batch Loss: 1.4047449827194214
Batch 个数 250, 当前Batch Loss: 1.6129717826843262
Batch 个数 300, 当前Batch Loss: 1.2970019578933716
Batch 个数 350, 当前Batch Loss: 1.5284892320632935
Epoch [10/50], Loss: 1.5598
Batch 个数 0, 当前Batch Loss: 1.1915580034255981
Batch 个数 50, 当前Batch Loss: 1.6355470418930054
Batch 个数 100, 当前Batch Loss: 1.2345329523086548
Batch 个数 150, 当前Batch Loss: 1.6134170293807983
Batch 个数 200, 当前Batch Loss: 1.5966219902038574
Batch 个数 250, 当前Batch Loss: 1.0698213577270508
Batch 个数 300, 当前Batch Loss: 1.5759248733520508
Batch 个数 350, 当前Batch Loss: 1.2298425436019897
Epoch [11/50], Loss: 1.2942
Batch 个数 0, 当前Batch Loss: 1.3267818689346313
Batch 个数 50, 当前Batch Loss: 1.05660080909729
Batch 个数 100, 当前Batch Loss: 1.3118940591812134
Batch 个数 150, 当前Batch Loss: 1.1038106679916382
Batch 个数 200, 当前Batch Loss: 1.0580699443817139
Batch 个数 250, 当前Batch Loss: 0.83199143409729
Batch 个数 300, 当前Batch Loss: 1.0214862823486328
Batch 个数 350, 当前Batch Loss: 1.0876731872558594
Epoch [12/50], Loss: 1.0225
Batch 个数 0, 当前Batch Loss: 0.7320798635482788
Batch 个数 50, 当前Batch Loss: 0.6110637187957764
Batch 个数 100, 当前Batch Loss: 0.7896550297737122
Batch 个数 150, 当前Batch Loss: 0.688700795173645
Batch 个数 200, 当前Batch Loss: 0.6180720925331116
Batch 个数 250, 当前Batch Loss: 0.8887027502059937
Batch 个数 300, 当前Batch Loss: 0.8215779662132263
Batch 个数 350, 当前Batch Loss: 0.896312952041626
Epoch [13/50], Loss: 0.7804
Batch 个数 0, 当前Batch Loss: 0.8259853720664978
Batch 个数 50, 当前Batch Loss: 0.651195228099823
Batch 个数 100, 当前Batch Loss: 0.38977834582328796
Batch 个数 150, 当前Batch Loss: 0.5044138431549072
Batch 个数 200, 当前Batch Loss: 0.7012751698493958
Batch 个数 250, 当前Batch Loss: 0.6142324805259705
Batch 个数 300, 当前Batch Loss: 0.5457307696342468
Batch 个数 350, 当前Batch Loss: 0.5756233334541321
Epoch [14/50], Loss: 0.6299
Batch 个数 0, 当前Batch Loss: 0.41713353991508484
Batch 个数 50, 当前Batch Loss: 0.21876347064971924
Batch 个数 100, 当前Batch Loss: 0.35326388478279114
Batch 个数 150, 当前Batch Loss: 0.6707578301429749
Batch 个数 200, 当前Batch Loss: 0.7119364738464355
Batch 个数 250, 当前Batch Loss: 0.4340774118900299
Batch 个数 300, 当前Batch Loss: 0.4260399341583252
Batch 个数 350, 当前Batch Loss: 0.3545307219028473
Epoch [15/50], Loss: 0.5377
Batch 个数 0, 当前Batch Loss: 0.4678197503089905
Batch 个数 50, 当前Batch Loss: 0.4482828378677368
Batch 个数 100, 当前Batch Loss: 0.505496621131897
Batch 个数 150, 当前Batch Loss: 0.6696577668190002
Batch 个数 200, 当前Batch Loss: 0.46820053458213806
Batch 个数 250, 当前Batch Loss: 0.5157697200775146
Batch 个数 300, 当前Batch Loss: 0.30850058794021606
Batch 个数 350, 当前Batch Loss: 0.35873886942863464
Epoch [16/50], Loss: 0.4757
Batch 个数 0, 当前Batch Loss: 0.5227290987968445
Batch 个数 50, 当前Batch Loss: 0.5735498666763306
Batch 个数 100, 当前Batch Loss: 0.25566762685775757
Batch 个数 150, 当前Batch Loss: 0.4463557302951813
Batch 个数 200, 当前Batch Loss: 0.5160642862319946
Batch 个数 250, 当前Batch Loss: 0.5508800148963928
Batch 个数 300, 当前Batch Loss: 0.20743244886398315
Batch 个数 350, 当前Batch Loss: 0.4683091640472412
Epoch [17/50], Loss: 0.4294
Batch 个数 0, 当前Batch Loss: 0.4610471725463867
Batch 个数 50, 当前Batch Loss: 0.20949025452136993
Batch 个数 100, 当前Batch Loss: 0.3095249831676483
Batch 个数 150, 当前Batch Loss: 0.5343061685562134
Batch 个数 200, 当前Batch Loss: 0.21672087907791138
Batch 个数 250, 当前Batch Loss: 0.26671090722084045
Batch 个数 300, 当前Batch Loss: 0.3715801537036896
Batch 个数 350, 当前Batch Loss: 0.33530187606811523
Epoch [18/50], Loss: 0.3954
Batch 个数 0, 当前Batch Loss: 0.2596697211265564
Batch 个数 50, 当前Batch Loss: 0.3352523744106293
Batch 个数 100, 当前Batch Loss: 0.5452763438224792
Batch 个数 150, 当前Batch Loss: 0.6085166931152344
Batch 个数 200, 当前Batch Loss: 0.2536132335662842
Batch 个数 250, 当前Batch Loss: 0.6624659299850464
Batch 个数 300, 当前Batch Loss: 0.13233652710914612
Batch 个数 350, 当前Batch Loss: 0.3240838646888733
Epoch [19/50], Loss: 0.3670
Batch 个数 0, 当前Batch Loss: 0.3560425341129303
Batch 个数 50, 当前Batch Loss: 0.5328636169433594
Batch 个数 100, 当前Batch Loss: 0.6616320610046387
Batch 个数 150, 当前Batch Loss: 0.31394875049591064
Batch 个数 200, 当前Batch Loss: 0.33214157819747925
Batch 个数 250, 当前Batch Loss: 0.45380541682243347
Batch 个数 300, 当前Batch Loss: 0.15528787672519684
Batch 个数 350, 当前Batch Loss: 0.7118860483169556
Epoch [20/50], Loss: 0.3433
Batch 个数 0, 当前Batch Loss: 0.29706084728240967
Batch 个数 50, 当前Batch Loss: 0.30909860134124756
Batch 个数 100, 当前Batch Loss: 0.5082835555076599
Batch 个数 150, 当前Batch Loss: 0.33033135533332825
Batch 个数 200, 当前Batch Loss: 0.5145041942596436
Batch 个数 250, 当前Batch Loss: 0.35946038365364075
Batch 个数 300, 当前Batch Loss: 0.32476142048835754
Batch 个数 350, 当前Batch Loss: 0.13613228499889374
Epoch [21/50], Loss: 0.3235
Batch 个数 0, 当前Batch Loss: 0.6552332639694214
Batch 个数 50, 当前Batch Loss: 0.4467589855194092
Batch 个数 100, 当前Batch Loss: 0.3183652460575104
Batch 个数 150, 当前Batch Loss: 0.3326844573020935
Batch 个数 200, 当前Batch Loss: 0.22880244255065918
Batch 个数 250, 当前Batch Loss: 0.4040409028530121
Batch 个数 300, 当前Batch Loss: 0.32657960057258606
Batch 个数 350, 当前Batch Loss: 0.32372912764549255
Epoch [22/50], Loss: 0.3032
Batch 个数 0, 当前Batch Loss: 0.2467297613620758
Batch 个数 50, 当前Batch Loss: 0.19321046769618988
Batch 个数 100, 当前Batch Loss: 0.4390961229801178
Batch 个数 150, 当前Batch Loss: 0.20507487654685974
Batch 个数 200, 当前Batch Loss: 0.21969394385814667
Batch 个数 250, 当前Batch Loss: 0.4641003906726837
Batch 个数 300, 当前Batch Loss: 0.38243305683135986
Batch 个数 350, 当前Batch Loss: 0.2658121585845947
Epoch [23/50], Loss: 0.2868
Batch 个数 0, 当前Batch Loss: 0.2722868025302887
Batch 个数 50, 当前Batch Loss: 0.1083257645368576
Batch 个数 100, 当前Batch Loss: 0.2649666965007782
Batch 个数 150, 当前Batch Loss: 0.30598002672195435
Batch 个数 200, 当前Batch Loss: 0.30979230999946594
Batch 个数 250, 当前Batch Loss: 0.09405697882175446
Batch 个数 300, 当前Batch Loss: 0.34231188893318176
Batch 个数 350, 当前Batch Loss: 0.32104840874671936
Epoch [24/50], Loss: 0.2735
Batch 个数 0, 当前Batch Loss: 0.241331547498703
Batch 个数 50, 当前Batch Loss: 0.18196162581443787
Batch 个数 100, 当前Batch Loss: 0.17463107407093048
Batch 个数 150, 当前Batch Loss: 0.14029724895954132
Batch 个数 200, 当前Batch Loss: 0.31951406598091125
Batch 个数 250, 当前Batch Loss: 0.2434973120689392
Batch 个数 300, 当前Batch Loss: 0.20299933850765228
Batch 个数 350, 当前Batch Loss: 0.25145575404167175
Epoch [25/50], Loss: 0.2591
Batch 个数 0, 当前Batch Loss: 0.12972544133663177
Batch 个数 50, 当前Batch Loss: 0.17020584642887115
Batch 个数 100, 当前Batch Loss: 0.19073620438575745
Batch 个数 150, 当前Batch Loss: 0.22905710339546204
Batch 个数 200, 当前Batch Loss: 0.31827929615974426
Batch 个数 250, 当前Batch Loss: 0.23469188809394836
Batch 个数 300, 当前Batch Loss: 0.1479714810848236
Batch 个数 350, 当前Batch Loss: 0.47163984179496765
Epoch [26/50], Loss: 0.2477
Batch 个数 0, 当前Batch Loss: 0.07168757915496826
Batch 个数 50, 当前Batch Loss: 0.08778432756662369
Batch 个数 100, 当前Batch Loss: 0.2785035967826843
Batch 个数 150, 当前Batch Loss: 0.24778947234153748
Batch 个数 200, 当前Batch Loss: 0.23097017407417297
Batch 个数 250, 当前Batch Loss: 0.308830201625824
Batch 个数 300, 当前Batch Loss: 0.36468619108200073
Batch 个数 350, 当前Batch Loss: 0.256717324256897
Epoch [27/50], Loss: 0.2363
Batch 个数 0, 当前Batch Loss: 0.07706815004348755
Batch 个数 50, 当前Batch Loss: 0.26761123538017273
Batch 个数 100, 当前Batch Loss: 0.3221053183078766
Batch 个数 150, 当前Batch Loss: 0.36338984966278076
Batch 个数 200, 当前Batch Loss: 0.13254250586032867
Batch 个数 250, 当前Batch Loss: 0.1402834802865982
Batch 个数 300, 当前Batch Loss: 0.37660127878189087
Batch 个数 350, 当前Batch Loss: 0.15694013237953186
Epoch [28/50], Loss: 0.2258
Batch 个数 0, 当前Batch Loss: 0.280354380607605
Batch 个数 50, 当前Batch Loss: 0.16188402473926544
Batch 个数 100, 当前Batch Loss: 0.13239437341690063
Batch 个数 150, 当前Batch Loss: 0.23482687771320343
Batch 个数 200, 当前Batch Loss: 0.19327814877033234
Batch 个数 250, 当前Batch Loss: 0.36168915033340454
Batch 个数 300, 当前Batch Loss: 0.09525027126073837
Batch 个数 350, 当前Batch Loss: 0.23604942858219147
Epoch [29/50], Loss: 0.2155
Batch 个数 0, 当前Batch Loss: 0.14801625907421112
Batch 个数 50, 当前Batch Loss: 0.395730197429657
Batch 个数 100, 当前Batch Loss: 0.10899042338132858
Batch 个数 150, 当前Batch Loss: 0.14991240203380585
Batch 个数 200, 当前Batch Loss: 0.12610074877738953
Batch 个数 250, 当前Batch Loss: 0.4038199484348297
Batch 个数 300, 当前Batch Loss: 0.09967715293169022
Batch 个数 350, 当前Batch Loss: 0.32503435015678406
Epoch [30/50], Loss: 0.2065
Batch 个数 0, 当前Batch Loss: 0.2644844353199005
Batch 个数 50, 当前Batch Loss: 0.510714590549469
Batch 个数 100, 当前Batch Loss: 0.10916104167699814
Batch 个数 150, 当前Batch Loss: 0.09489254653453827
Batch 个数 200, 当前Batch Loss: 0.1813802570104599
Batch 个数 250, 当前Batch Loss: 0.06019286811351776
Batch 个数 300, 当前Batch Loss: 0.0991126149892807
Batch 个数 350, 当前Batch Loss: 0.133945032954216
Epoch [31/50], Loss: 0.1970
Batch 个数 0, 当前Batch Loss: 0.07228928059339523
Batch 个数 50, 当前Batch Loss: 0.11341184377670288
Batch 个数 100, 当前Batch Loss: 0.11671314388513565
Batch 个数 150, 当前Batch Loss: 0.2586458921432495
Batch 个数 200, 当前Batch Loss: 0.15504279732704163
Batch 个数 250, 当前Batch Loss: 0.17470727860927582
Batch 个数 300, 当前Batch Loss: 0.23792575299739838
Batch 个数 350, 当前Batch Loss: 0.1844589114189148
Epoch [32/50], Loss: 0.1892
Batch 个数 0, 当前Batch Loss: 0.1419484168291092
Batch 个数 50, 当前Batch Loss: 0.3592585325241089
Batch 个数 100, 当前Batch Loss: 0.18747714161872864
Batch 个数 150, 当前Batch Loss: 0.25853773951530457
Batch 个数 200, 当前Batch Loss: 0.19716285169124603
Batch 个数 250, 当前Batch Loss: 0.07905702292919159
Batch 个数 300, 当前Batch Loss: 0.3451858162879944
Batch 个数 350, 当前Batch Loss: 0.15031278133392334
Epoch [33/50], Loss: 0.1815
Batch 个数 0, 当前Batch Loss: 0.3312881886959076
Batch 个数 50, 当前Batch Loss: 0.05347651615738869
Batch 个数 100, 当前Batch Loss: 0.13915307819843292
Batch 个数 150, 当前Batch Loss: 0.1815675050020218
Batch 个数 200, 当前Batch Loss: 0.0871158018708229
Batch 个数 250, 当前Batch Loss: 0.14362436532974243
Batch 个数 300, 当前Batch Loss: 0.11935178935527802
Batch 个数 350, 当前Batch Loss: 0.16263118386268616
Epoch [34/50], Loss: 0.1729
Batch 个数 0, 当前Batch Loss: 0.11560959368944168
Batch 个数 50, 当前Batch Loss: 0.10682961344718933
Batch 个数 100, 当前Batch Loss: 0.14393605291843414
Batch 个数 150, 当前Batch Loss: 0.1226387619972229
Batch 个数 200, 当前Batch Loss: 0.3672790825366974
Batch 个数 250, 当前Batch Loss: 0.08847299963235855
Batch 个数 300, 当前Batch Loss: 0.20549528300762177
Batch 个数 350, 当前Batch Loss: 0.15515348315238953
Epoch [35/50], Loss: 0.1649
Batch 个数 0, 当前Batch Loss: 0.06616134941577911
Batch 个数 50, 当前Batch Loss: 0.113344207406044
Batch 个数 100, 当前Batch Loss: 0.13461966812610626
Batch 个数 150, 当前Batch Loss: 0.08070296794176102
Batch 个数 200, 当前Batch Loss: 0.06993405520915985
Batch 个数 250, 当前Batch Loss: 0.2888775169849396
Batch 个数 300, 当前Batch Loss: 0.3502104878425598
Batch 个数 350, 当前Batch Loss: 0.07606375962495804
Epoch [36/50], Loss: 0.1576
Batch 个数 0, 当前Batch Loss: 0.12490073591470718
Batch 个数 50, 当前Batch Loss: 0.12764118611812592
Batch 个数 100, 当前Batch Loss: 0.19962549209594727
Batch 个数 150, 当前Batch Loss: 0.2751319706439972
Batch 个数 200, 当前Batch Loss: 0.022960245609283447
Batch 个数 250, 当前Batch Loss: 0.21051432192325592
Batch 个数 300, 当前Batch Loss: 0.08177103102207184
Batch 个数 350, 当前Batch Loss: 0.11608223617076874
Epoch [37/50], Loss: 0.1517
Batch 个数 0, 当前Batch Loss: 0.3137512803077698
Batch 个数 50, 当前Batch Loss: 0.4622594714164734
Batch 个数 100, 当前Batch Loss: 0.10602541267871857
Batch 个数 150, 当前Batch Loss: 0.15086640417575836
Batch 个数 200, 当前Batch Loss: 0.0643632635474205
Batch 个数 250, 当前Batch Loss: 0.16516783833503723
Batch 个数 300, 当前Batch Loss: 0.10256883502006531
Batch 个数 350, 当前Batch Loss: 0.09888266772031784
Epoch [38/50], Loss: 0.1444
Batch 个数 0, 当前Batch Loss: 0.2195480465888977
Batch 个数 50, 当前Batch Loss: 0.08082824945449829
Batch 个数 100, 当前Batch Loss: 0.16855785250663757
Batch 个数 150, 当前Batch Loss: 0.14845319092273712
Batch 个数 200, 当前Batch Loss: 0.0458160936832428
Batch 个数 250, 当前Batch Loss: 0.05022723972797394
Batch 个数 300, 当前Batch Loss: 0.049937184900045395
Batch 个数 350, 当前Batch Loss: 0.022582853212952614
Epoch [39/50], Loss: 0.1380
Batch 个数 0, 当前Batch Loss: 0.06531217694282532
Batch 个数 50, 当前Batch Loss: 0.09061405062675476
Batch 个数 100, 当前Batch Loss: 0.09157150238752365
Batch 个数 150, 当前Batch Loss: 0.3407338857650757
Batch 个数 200, 当前Batch Loss: 0.1121196523308754
Batch 个数 250, 当前Batch Loss: 0.10030671209096909
Batch 个数 300, 当前Batch Loss: 0.3079396188259125
Batch 个数 350, 当前Batch Loss: 0.2211892306804657
Epoch [40/50], Loss: 0.1316
Batch 个数 0, 当前Batch Loss: 0.25366100668907166
Batch 个数 50, 当前Batch Loss: 0.25217798352241516
Batch 个数 100, 当前Batch Loss: 0.22276116907596588
Batch 个数 150, 当前Batch Loss: 0.10849515348672867
Batch 个数 200, 当前Batch Loss: 0.10104724764823914
Batch 个数 250, 当前Batch Loss: 0.2378980666399002
Batch 个数 300, 当前Batch Loss: 0.11122623085975647
Batch 个数 350, 当前Batch Loss: 0.3878173828125
Epoch [41/50], Loss: 0.1262
Batch 个数 0, 当前Batch Loss: 0.09424293786287308
Batch 个数 50, 当前Batch Loss: 0.09584295749664307
Batch 个数 100, 当前Batch Loss: 0.10233072191476822
Batch 个数 150, 当前Batch Loss: 0.16012032330036163
Batch 个数 200, 当前Batch Loss: 0.537704586982727
Batch 个数 250, 当前Batch Loss: 0.15169045329093933
Batch 个数 300, 当前Batch Loss: 0.11552385985851288
Batch 个数 350, 当前Batch Loss: 0.17879122495651245
Epoch [42/50], Loss: 0.1215
Batch 个数 0, 当前Batch Loss: 0.08426967263221741
Batch 个数 50, 当前Batch Loss: 0.10501328855752945
Batch 个数 100, 当前Batch Loss: 0.11522939801216125
Batch 个数 150, 当前Batch Loss: 0.04328415170311928
Batch 个数 200, 当前Batch Loss: 0.08867376297712326
Batch 个数 250, 当前Batch Loss: 0.25669875741004944
Batch 个数 300, 当前Batch Loss: 0.23022378981113434
Batch 个数 350, 当前Batch Loss: 0.07437845319509506
Epoch [43/50], Loss: 0.1166
Batch 个数 0, 当前Batch Loss: 0.29630669951438904
Batch 个数 50, 当前Batch Loss: 0.053016599267721176
Batch 个数 100, 当前Batch Loss: 0.075246661901474
Batch 个数 150, 当前Batch Loss: 0.1438019871711731
Batch 个数 200, 当前Batch Loss: 0.05541811138391495
Batch 个数 250, 当前Batch Loss: 0.12153924256563187
Batch 个数 300, 当前Batch Loss: 0.10904598981142044
Batch 个数 350, 当前Batch Loss: 0.0731244757771492
Epoch [44/50], Loss: 0.1120
Batch 个数 0, 当前Batch Loss: 0.04898514226078987
Batch 个数 50, 当前Batch Loss: 0.07089806348085403
Batch 个数 100, 当前Batch Loss: 0.061536990106105804
Batch 个数 150, 当前Batch Loss: 0.15694504976272583
Batch 个数 200, 当前Batch Loss: 0.0464174710214138
Batch 个数 250, 当前Batch Loss: 0.11556290835142136
Batch 个数 300, 当前Batch Loss: 0.18966422975063324
Batch 个数 350, 当前Batch Loss: 0.047723438590765
Epoch [45/50], Loss: 0.1066
Batch 个数 0, 当前Batch Loss: 0.08474967628717422
Batch 个数 50, 当前Batch Loss: 0.14603395760059357
Batch 个数 100, 当前Batch Loss: 0.0921659842133522
Batch 个数 150, 当前Batch Loss: 0.05787872523069382
Batch 个数 200, 当前Batch Loss: 0.0379343181848526
Batch 个数 250, 当前Batch Loss: 0.2057540863752365
Batch 个数 300, 当前Batch Loss: 0.2765900194644928
Batch 个数 350, 当前Batch Loss: 0.20073074102401733
Epoch [46/50], Loss: 0.1012
Batch 个数 0, 当前Batch Loss: 0.05583445727825165
Batch 个数 50, 当前Batch Loss: 0.10909398645162582
Batch 个数 100, 当前Batch Loss: 0.1858704388141632
Batch 个数 150, 当前Batch Loss: 0.03422796353697777
Batch 个数 200, 当前Batch Loss: 0.029675999656319618
Batch 个数 250, 当前Batch Loss: 0.05068732053041458
Batch 个数 300, 当前Batch Loss: 0.0512855090200901
Batch 个数 350, 当前Batch Loss: 0.08319473266601562
Epoch [47/50], Loss: 0.0968
Batch 个数 0, 当前Batch Loss: 0.11538860946893692
Batch 个数 50, 当前Batch Loss: 0.022574827075004578
Batch 个数 100, 当前Batch Loss: 0.2419111132621765
Batch 个数 150, 当前Batch Loss: 0.10839808732271194
Batch 个数 200, 当前Batch Loss: 0.10049376636743546
Batch 个数 250, 当前Batch Loss: 0.07891305536031723
Batch 个数 300, 当前Batch Loss: 0.12565530836582184
Batch 个数 350, 当前Batch Loss: 0.15829715132713318
Epoch [48/50], Loss: 0.0934
Batch 个数 0, 当前Batch Loss: 0.1603211909532547
Batch 个数 50, 当前Batch Loss: 0.22180946171283722
Batch 个数 100, 当前Batch Loss: 0.03589488938450813
Batch 个数 150, 当前Batch Loss: 0.25459152460098267
Batch 个数 200, 当前Batch Loss: 0.023668130859732628
Batch 个数 250, 当前Batch Loss: 0.0310873631387949
Batch 个数 300, 当前Batch Loss: 0.037382278591394424
Batch 个数 350, 当前Batch Loss: 0.21062317490577698
Epoch [49/50], Loss: 0.0893
Batch 个数 0, 当前Batch Loss: 0.2030823826789856
Batch 个数 50, 当前Batch Loss: 0.03897205740213394
Batch 个数 100, 当前Batch Loss: 0.014401096850633621
Batch 个数 150, 当前Batch Loss: 0.13396765291690826
Batch 个数 200, 当前Batch Loss: 0.08148515224456787
Batch 个数 250, 当前Batch Loss: 0.038050178438425064
Batch 个数 300, 当前Batch Loss: 0.08658981323242188
Batch 个数 350, 当前Batch Loss: 0.15728330612182617
Epoch [50/50], Loss: 0.0846
输入 '帮我导航到北京' 预测为: 'Travel-Query'
输入 '查询明天北京的天气' 预测为: 'Weather-Query'

隐藏层个数为3，通道数为64, 64,64

Batch 个数 0, 当前Batch Loss: 2.5130224227905273
Batch 个数 50, 当前Batch Loss: 2.475714921951294
Batch 个数 100, 当前Batch Loss: 2.4794321060180664
Batch 个数 150, 当前Batch Loss: 2.4788455963134766
Batch 个数 200, 当前Batch Loss: 2.4430112838745117
Batch 个数 250, 当前Batch Loss: 2.4108431339263916
Batch 个数 300, 当前Batch Loss: 2.4406065940856934
Batch 个数 350, 当前Batch Loss: 2.4458184242248535
Epoch [1/50], Loss: 2.4605
Batch 个数 0, 当前Batch Loss: 2.4360101222991943
Batch 个数 50, 当前Batch Loss: 2.4418323040008545
Batch 个数 100, 当前Batch Loss: 2.4328060150146484
Batch 个数 150, 当前Batch Loss: 2.4110429286956787
Batch 个数 200, 当前Batch Loss: 2.4173038005828857
Batch 个数 250, 当前Batch Loss: 2.4433650970458984
Batch 个数 300, 当前Batch Loss: 2.3712048530578613
Batch 个数 350, 当前Batch Loss: 2.4058890342712402
Epoch [2/50], Loss: 2.4083
Batch 个数 0, 当前Batch Loss: 2.4263296127319336
Batch 个数 50, 当前Batch Loss: 2.35677170753479
Batch 个数 100, 当前Batch Loss: 2.356999635696411
Batch 个数 150, 当前Batch Loss: 2.4045348167419434
Batch 个数 200, 当前Batch Loss: 2.3354909420013428
Batch 个数 250, 当前Batch Loss: 2.369236469268799
Batch 个数 300, 当前Batch Loss: 2.4200122356414795
Batch 个数 350, 当前Batch Loss: 2.37158465385437
Epoch [3/50], Loss: 2.3771
Batch 个数 0, 当前Batch Loss: 2.3167786598205566
Batch 个数 50, 当前Batch Loss: 2.372516393661499
Batch 个数 100, 当前Batch Loss: 2.379800796508789
Batch 个数 150, 当前Batch Loss: 2.368547201156616
Batch 个数 200, 当前Batch Loss: 2.32694149017334
Batch 个数 250, 当前Batch Loss: 2.425856351852417
Batch 个数 300, 当前Batch Loss: 2.3242533206939697
Batch 个数 350, 当前Batch Loss: 2.322021245956421
Epoch [4/50], Loss: 2.3577
Batch 个数 0, 当前Batch Loss: 2.352917432785034
Batch 个数 50, 当前Batch Loss: 2.392726182937622
Batch 个数 100, 当前Batch Loss: 2.322920560836792
Batch 个数 150, 当前Batch Loss: 2.2642621994018555
Batch 个数 200, 当前Batch Loss: 2.348085403442383
Batch 个数 250, 当前Batch Loss: 2.2979040145874023
Batch 个数 300, 当前Batch Loss: 2.3771588802337646
Batch 个数 350, 当前Batch Loss: 2.2607014179229736
Epoch [5/50], Loss: 2.3443
Batch 个数 0, 当前Batch Loss: 2.4304041862487793
Batch 个数 50, 当前Batch Loss: 2.3034768104553223
Batch 个数 100, 当前Batch Loss: 2.30996036529541
Batch 个数 150, 当前Batch Loss: 2.2462196350097656
Batch 个数 200, 当前Batch Loss: 2.275697946548462
Batch 个数 250, 当前Batch Loss: 2.4350013732910156
Batch 个数 300, 当前Batch Loss: 2.24944806098938
Batch 个数 350, 当前Batch Loss: 2.319427013397217
Epoch [6/50], Loss: 2.3309
Batch 个数 0, 当前Batch Loss: 2.2868335247039795
Batch 个数 50, 当前Batch Loss: 2.3848485946655273
Batch 个数 100, 当前Batch Loss: 2.230846405029297
Batch 个数 150, 当前Batch Loss: 2.2651376724243164
Batch 个数 200, 当前Batch Loss: 2.381908893585205
Batch 个数 250, 当前Batch Loss: 2.274778127670288
Batch 个数 300, 当前Batch Loss: 2.422466993331909
Batch 个数 350, 当前Batch Loss: 2.365359306335449
Epoch [7/50], Loss: 2.3111
Batch 个数 0, 当前Batch Loss: 2.41033935546875
Batch 个数 50, 当前Batch Loss: 2.1962594985961914
Batch 个数 100, 当前Batch Loss: 2.227739095687866
Batch 个数 150, 当前Batch Loss: 2.546633005142212
Batch 个数 200, 当前Batch Loss: 2.351938009262085
Batch 个数 250, 当前Batch Loss: 2.348072052001953
Batch 个数 300, 当前Batch Loss: 2.222827196121216
Batch 个数 350, 当前Batch Loss: 2.2298648357391357
Epoch [8/50], Loss: 2.2690
Batch 个数 0, 当前Batch Loss: 2.1990065574645996
Batch 个数 50, 当前Batch Loss: 2.470790386199951
Batch 个数 100, 当前Batch Loss: 2.2771637439727783
Batch 个数 150, 当前Batch Loss: 2.3421905040740967
Batch 个数 200, 当前Batch Loss: 2.18234920501709
Batch 个数 250, 当前Batch Loss: 2.084367036819458
Batch 个数 300, 当前Batch Loss: 2.267550468444824
Batch 个数 350, 当前Batch Loss: 1.9815518856048584
Epoch [9/50], Loss: 2.1581
Batch 个数 0, 当前Batch Loss: 1.9293221235275269
Batch 个数 50, 当前Batch Loss: 2.027498960494995
Batch 个数 100, 当前Batch Loss: 1.9864180088043213
Batch 个数 150, 当前Batch Loss: 2.0608508586883545
Batch 个数 200, 当前Batch Loss: 1.9506033658981323
Batch 个数 250, 当前Batch Loss: 1.8048748970031738
Batch 个数 300, 当前Batch Loss: 1.6889539957046509
Batch 个数 350, 当前Batch Loss: 1.8206061124801636
Epoch [10/50], Loss: 1.9143
Batch 个数 0, 当前Batch Loss: 1.7277531623840332
Batch 个数 50, 当前Batch Loss: 1.8503578901290894
Batch 个数 100, 当前Batch Loss: 1.8366390466690063
Batch 个数 150, 当前Batch Loss: 1.5991077423095703
Batch 个数 200, 当前Batch Loss: 1.4005825519561768
Batch 个数 250, 当前Batch Loss: 1.4781467914581299
Batch 个数 300, 当前Batch Loss: 1.5002825260162354
Batch 个数 350, 当前Batch Loss: 1.1836165189743042
Epoch [11/50], Loss: 1.5576
Batch 个数 0, 当前Batch Loss: 1.3396939039230347
Batch 个数 50, 当前Batch Loss: 1.3653210401535034
Batch 个数 100, 当前Batch Loss: 1.3110473155975342
Batch 个数 150, 当前Batch Loss: 1.011364459991455
Batch 个数 200, 当前Batch Loss: 1.25673508644104
Batch 个数 250, 当前Batch Loss: 0.9497134685516357
Batch 个数 300, 当前Batch Loss: 1.07427179813385
Batch 个数 350, 当前Batch Loss: 1.088351845741272
Epoch [12/50], Loss: 1.1849
Batch 个数 0, 当前Batch Loss: 0.783784806728363
Batch 个数 50, 当前Batch Loss: 1.2718865871429443
Batch 个数 100, 当前Batch Loss: 0.9185537099838257
Batch 个数 150, 当前Batch Loss: 0.7788040637969971
Batch 个数 200, 当前Batch Loss: 0.7394475340843201
Batch 个数 250, 当前Batch Loss: 0.9532033801078796
Batch 个数 300, 当前Batch Loss: 1.042881965637207
Batch 个数 350, 当前Batch Loss: 0.7426827549934387
Epoch [13/50], Loss: 0.8814
Batch 个数 0, 当前Batch Loss: 0.8186011910438538
Batch 个数 50, 当前Batch Loss: 0.46737512946128845
Batch 个数 100, 当前Batch Loss: 0.6565687656402588
Batch 个数 150, 当前Batch Loss: 0.9563851356506348
Batch 个数 200, 当前Batch Loss: 0.7302395105361938
Batch 个数 250, 当前Batch Loss: 0.9502796530723572
Batch 个数 300, 当前Batch Loss: 0.8671648502349854
Batch 个数 350, 当前Batch Loss: 0.777511477470398
Epoch [14/50], Loss: 0.6988
Batch 个数 0, 当前Batch Loss: 0.638527512550354
Batch 个数 50, 当前Batch Loss: 1.0058774948120117
Batch 个数 100, 当前Batch Loss: 0.588104784488678
Batch 个数 150, 当前Batch Loss: 0.6551162004470825
Batch 个数 200, 当前Batch Loss: 0.606264054775238
Batch 个数 250, 当前Batch Loss: 0.7121143937110901
Batch 个数 300, 当前Batch Loss: 0.4933337867259979
Batch 个数 350, 当前Batch Loss: 0.3356686234474182
Epoch [15/50], Loss: 0.5962
Batch 个数 0, 当前Batch Loss: 0.37149086594581604
Batch 个数 50, 当前Batch Loss: 0.28011295199394226
Batch 个数 100, 当前Batch Loss: 0.6747745871543884
Batch 个数 150, 当前Batch Loss: 0.6799993515014648
Batch 个数 200, 当前Batch Loss: 0.3090599775314331
Batch 个数 250, 当前Batch Loss: 0.40278857946395874
Batch 个数 300, 当前Batch Loss: 0.34366223216056824
Batch 个数 350, 当前Batch Loss: 0.3883677124977112
Epoch [16/50], Loss: 0.5290
Batch 个数 0, 当前Batch Loss: 0.5306702852249146
Batch 个数 50, 当前Batch Loss: 0.7087502479553223
Batch 个数 100, 当前Batch Loss: 0.4662759006023407
Batch 个数 150, 当前Batch Loss: 0.6031825542449951
Batch 个数 200, 当前Batch Loss: 0.3281010389328003
Batch 个数 250, 当前Batch Loss: 0.44085508584976196
Batch 个数 300, 当前Batch Loss: 0.36540350317955017
Batch 个数 350, 当前Batch Loss: 0.31104549765586853
Epoch [17/50], Loss: 0.4802
Batch 个数 0, 当前Batch Loss: 0.9688243269920349
Batch 个数 50, 当前Batch Loss: 0.24203583598136902
Batch 个数 100, 当前Batch Loss: 0.6842288374900818
Batch 个数 150, 当前Batch Loss: 0.36076197028160095
Batch 个数 200, 当前Batch Loss: 0.5190738439559937
Batch 个数 250, 当前Batch Loss: 0.4403616786003113
Batch 个数 300, 当前Batch Loss: 0.35027870535850525
Batch 个数 350, 当前Batch Loss: 0.36853188276290894
Epoch [18/50], Loss: 0.4404
Batch 个数 0, 当前Batch Loss: 0.7189899682998657
Batch 个数 50, 当前Batch Loss: 0.29654937982559204
Batch 个数 100, 当前Batch Loss: 0.3940628170967102
Batch 个数 150, 当前Batch Loss: 0.3218814730644226
Batch 个数 200, 当前Batch Loss: 0.790533185005188
Batch 个数 250, 当前Batch Loss: 0.3099951148033142
Batch 个数 300, 当前Batch Loss: 0.2302940934896469
Batch 个数 350, 当前Batch Loss: 0.19179795682430267
Epoch [19/50], Loss: 0.4078
Batch 个数 0, 当前Batch Loss: 0.19044819474220276
Batch 个数 50, 当前Batch Loss: 0.5548135042190552
Batch 个数 100, 当前Batch Loss: 0.20616234838962555
Batch 个数 150, 当前Batch Loss: 0.12526048719882965
Batch 个数 200, 当前Batch Loss: 0.3679145872592926
Batch 个数 250, 当前Batch Loss: 0.6563564538955688
Batch 个数 300, 当前Batch Loss: 0.5629507303237915
Batch 个数 350, 当前Batch Loss: 0.28740790486335754
Epoch [20/50], Loss: 0.3812
Batch 个数 0, 当前Batch Loss: 0.3404441475868225
Batch 个数 50, 当前Batch Loss: 0.3910609781742096
Batch 个数 100, 当前Batch Loss: 0.4175528883934021
Batch 个数 150, 当前Batch Loss: 0.26273807883262634
Batch 个数 200, 当前Batch Loss: 0.16065290570259094
Batch 个数 250, 当前Batch Loss: 0.24312874674797058
Batch 个数 300, 当前Batch Loss: 0.5723430514335632
Batch 个数 350, 当前Batch Loss: 0.28589552640914917
Epoch [21/50], Loss: 0.3585
Batch 个数 0, 当前Batch Loss: 0.23250563442707062
Batch 个数 50, 当前Batch Loss: 0.24208495020866394
Batch 个数 100, 当前Batch Loss: 0.23650731146335602
Batch 个数 150, 当前Batch Loss: 0.33702656626701355
Batch 个数 200, 当前Batch Loss: 0.2232389897108078
Batch 个数 250, 当前Batch Loss: 0.18687906861305237
Batch 个数 300, 当前Batch Loss: 0.4927158057689667
Batch 个数 350, 当前Batch Loss: 0.24048267304897308
Epoch [22/50], Loss: 0.3368
Batch 个数 0, 当前Batch Loss: 0.42698851227760315
Batch 个数 50, 当前Batch Loss: 0.4797433316707611
Batch 个数 100, 当前Batch Loss: 0.11134521663188934
Batch 个数 150, 当前Batch Loss: 0.387594997882843
Batch 个数 200, 当前Batch Loss: 0.23609179258346558
Batch 个数 250, 当前Batch Loss: 0.2962467074394226
Batch 个数 300, 当前Batch Loss: 0.10852750390768051
Batch 个数 350, 当前Batch Loss: 0.2257716804742813
Epoch [23/50], Loss: 0.3203
Batch 个数 0, 当前Batch Loss: 0.2647685408592224
Batch 个数 50, 当前Batch Loss: 0.2843184173107147
Batch 个数 100, 当前Batch Loss: 0.10504959523677826
Batch 个数 150, 当前Batch Loss: 0.5267356038093567
Batch 个数 200, 当前Batch Loss: 0.14328378438949585
Batch 个数 250, 当前Batch Loss: 0.25441086292266846
Batch 个数 300, 当前Batch Loss: 0.3441247344017029
Batch 个数 350, 当前Batch Loss: 0.5268844366073608
Epoch [24/50], Loss: 0.3028
Batch 个数 0, 当前Batch Loss: 0.3391738533973694
Batch 个数 50, 当前Batch Loss: 0.12015458941459656
Batch 个数 100, 当前Batch Loss: 0.3324202299118042
Batch 个数 150, 当前Batch Loss: 0.25484928488731384
Batch 个数 200, 当前Batch Loss: 0.49634480476379395
Batch 个数 250, 当前Batch Loss: 0.579633355140686
Batch 个数 300, 当前Batch Loss: 0.3628612756729126
Batch 个数 350, 当前Batch Loss: 0.34984472393989563
Epoch [25/50], Loss: 0.2872
Batch 个数 0, 当前Batch Loss: 0.3211725354194641
Batch 个数 50, 当前Batch Loss: 0.4866000711917877
Batch 个数 100, 当前Batch Loss: 0.15848875045776367
Batch 个数 150, 当前Batch Loss: 0.23601111769676208
Batch 个数 200, 当前Batch Loss: 0.409577339887619
Batch 个数 250, 当前Batch Loss: 0.2597990036010742
Batch 个数 300, 当前Batch Loss: 0.22358065843582153
Batch 个数 350, 当前Batch Loss: 0.32698142528533936
Epoch [26/50], Loss: 0.2721
Batch 个数 0, 当前Batch Loss: 0.5105471611022949
Batch 个数 50, 当前Batch Loss: 0.2368284910917282
Batch 个数 100, 当前Batch Loss: 0.3698040544986725
Batch 个数 150, 当前Batch Loss: 0.2918800711631775
Batch 个数 200, 当前Batch Loss: 0.2354288399219513
Batch 个数 250, 当前Batch Loss: 0.25742408633232117
Batch 个数 300, 当前Batch Loss: 0.16178269684314728
Batch 个数 350, 当前Batch Loss: 0.19563686847686768
Epoch [27/50], Loss: 0.2617
Batch 个数 0, 当前Batch Loss: 0.39300522208213806
Batch 个数 50, 当前Batch Loss: 0.15686558187007904
Batch 个数 100, 当前Batch Loss: 0.2646515965461731
Batch 个数 150, 当前Batch Loss: 0.13503724336624146
Batch 个数 200, 当前Batch Loss: 0.11604738980531693
Batch 个数 250, 当前Batch Loss: 0.13742667436599731
Batch 个数 300, 当前Batch Loss: 0.19796453416347504
Batch 个数 350, 当前Batch Loss: 0.3052808344364166
Epoch [28/50], Loss: 0.2485
Batch 个数 0, 当前Batch Loss: 0.23713363707065582
Batch 个数 50, 当前Batch Loss: 0.0758926123380661
Batch 个数 100, 当前Batch Loss: 0.0508209764957428
Batch 个数 150, 当前Batch Loss: 0.06827804446220398
Batch 个数 200, 当前Batch Loss: 0.20150743424892426
Batch 个数 250, 当前Batch Loss: 0.11485294997692108
Batch 个数 300, 当前Batch Loss: 0.11820902675390244
Batch 个数 350, 当前Batch Loss: 0.5344687700271606
Epoch [29/50], Loss: 0.2365
Batch 个数 0, 当前Batch Loss: 0.28399455547332764
Batch 个数 50, 当前Batch Loss: 0.15775161981582642
Batch 个数 100, 当前Batch Loss: 0.4709705710411072
Batch 个数 150, 当前Batch Loss: 0.10695215314626694
Batch 个数 200, 当前Batch Loss: 0.10752847790718079
Batch 个数 250, 当前Batch Loss: 0.3307083249092102
Batch 个数 300, 当前Batch Loss: 0.027906497940421104
Batch 个数 350, 当前Batch Loss: 0.10604101419448853
Epoch [30/50], Loss: 0.2268
Batch 个数 0, 当前Batch Loss: 0.12617143988609314
Batch 个数 50, 当前Batch Loss: 0.19029100239276886
Batch 个数 100, 当前Batch Loss: 0.11984386295080185
Batch 个数 150, 当前Batch Loss: 0.14738163352012634
Batch 个数 200, 当前Batch Loss: 0.16650018095970154
Batch 个数 250, 当前Batch Loss: 0.1572497934103012
Batch 个数 300, 当前Batch Loss: 0.13681024312973022
Batch 个数 350, 当前Batch Loss: 0.06716664880514145
Epoch [31/50], Loss: 0.2148
Batch 个数 0, 当前Batch Loss: 0.12573306262493134
Batch 个数 50, 当前Batch Loss: 0.2088261991739273
Batch 个数 100, 当前Batch Loss: 0.027049364522099495
Batch 个数 150, 当前Batch Loss: 0.35929107666015625
Batch 个数 200, 当前Batch Loss: 0.19592228531837463
Batch 个数 250, 当前Batch Loss: 0.2581929862499237
Batch 个数 300, 当前Batch Loss: 0.3009602427482605
Batch 个数 350, 当前Batch Loss: 0.08797485381364822
Epoch [32/50], Loss: 0.2052
Batch 个数 0, 当前Batch Loss: 0.12200230360031128
Batch 个数 50, 当前Batch Loss: 0.3615643382072449
Batch 个数 100, 当前Batch Loss: 0.10999788343906403
Batch 个数 150, 当前Batch Loss: 0.1024802103638649
Batch 个数 200, 当前Batch Loss: 0.17013874650001526
Batch 个数 250, 当前Batch Loss: 0.05359144136309624
Batch 个数 300, 当前Batch Loss: 0.4413526952266693
Batch 个数 350, 当前Batch Loss: 0.09132399410009384
Epoch [33/50], Loss: 0.1968
Batch 个数 0, 当前Batch Loss: 0.317812979221344
Batch 个数 50, 当前Batch Loss: 0.07890957593917847
Batch 个数 100, 当前Batch Loss: 0.28505071997642517
Batch 个数 150, 当前Batch Loss: 0.13253426551818848
Batch 个数 200, 当前Batch Loss: 0.24796254932880402
Batch 个数 250, 当前Batch Loss: 0.22334782779216766
Batch 个数 300, 当前Batch Loss: 0.30156219005584717
Batch 个数 350, 当前Batch Loss: 0.27009013295173645
Epoch [34/50], Loss: 0.1884
Batch 个数 0, 当前Batch Loss: 0.16607898473739624
Batch 个数 50, 当前Batch Loss: 0.21283794939517975
Batch 个数 100, 当前Batch Loss: 0.24524050951004028
Batch 个数 150, 当前Batch Loss: 0.10453100502490997
Batch 个数 200, 当前Batch Loss: 0.20962190628051758
Batch 个数 250, 当前Batch Loss: 0.33919182419776917
Batch 个数 300, 当前Batch Loss: 0.17123198509216309
Batch 个数 350, 当前Batch Loss: 0.1532818228006363
Epoch [35/50], Loss: 0.1821
Batch 个数 0, 当前Batch Loss: 0.30123528838157654
Batch 个数 50, 当前Batch Loss: 0.12373460084199905
Batch 个数 100, 当前Batch Loss: 0.11667699366807938
Batch 个数 150, 当前Batch Loss: 0.14034788310527802
Batch 个数 200, 当前Batch Loss: 0.16606922447681427
Batch 个数 250, 当前Batch Loss: 0.08617986738681793
Batch 个数 300, 当前Batch Loss: 0.13907264173030853
Batch 个数 350, 当前Batch Loss: 0.2656511664390564
Epoch [36/50], Loss: 0.1713
Batch 个数 0, 当前Batch Loss: 0.27948394417762756
Batch 个数 50, 当前Batch Loss: 0.08508101105690002
Batch 个数 100, 当前Batch Loss: 0.2664266526699066
Batch 个数 150, 当前Batch Loss: 0.09952447563409805
Batch 个数 200, 当前Batch Loss: 0.17580002546310425
Batch 个数 250, 当前Batch Loss: 0.15143711864948273
Batch 个数 300, 当前Batch Loss: 0.24379006028175354
Batch 个数 350, 当前Batch Loss: 0.14634890854358673
Epoch [37/50], Loss: 0.1635
Batch 个数 0, 当前Batch Loss: 0.4798774719238281
Batch 个数 50, 当前Batch Loss: 0.07604286819696426
Batch 个数 100, 当前Batch Loss: 0.14404912292957306
Batch 个数 150, 当前Batch Loss: 0.1671021580696106
Batch 个数 200, 当前Batch Loss: 0.12635928392410278
Batch 个数 250, 当前Batch Loss: 0.16255013644695282
Batch 个数 300, 当前Batch Loss: 0.07302125543355942
Batch 个数 350, 当前Batch Loss: 0.13165567815303802
Epoch [38/50], Loss: 0.1559
Batch 个数 0, 当前Batch Loss: 0.10634223371744156
Batch 个数 50, 当前Batch Loss: 0.10380105674266815
Batch 个数 100, 当前Batch Loss: 0.23645594716072083
Batch 个数 150, 当前Batch Loss: 0.09150687605142593
Batch 个数 200, 当前Batch Loss: 0.1094701811671257
Batch 个数 250, 当前Batch Loss: 0.09830474853515625
Batch 个数 300, 当前Batch Loss: 0.28050297498703003
Batch 个数 350, 当前Batch Loss: 0.16702385246753693
Epoch [39/50], Loss: 0.1489
Batch 个数 0, 当前Batch Loss: 0.2634986340999603
Batch 个数 50, 当前Batch Loss: 0.06243306025862694
Batch 个数 100, 当前Batch Loss: 0.05882754549384117
Batch 个数 150, 当前Batch Loss: 0.08210685849189758
Batch 个数 200, 当前Batch Loss: 0.11617355793714523
Batch 个数 250, 当前Batch Loss: 0.04135149344801903
Batch 个数 300, 当前Batch Loss: 0.0740056112408638
Batch 个数 350, 当前Batch Loss: 0.015075214207172394
Epoch [40/50], Loss: 0.1421
Batch 个数 0, 当前Batch Loss: 0.06242688000202179
Batch 个数 50, 当前Batch Loss: 0.08135911822319031
Batch 个数 100, 当前Batch Loss: 0.07924380898475647
Batch 个数 150, 当前Batch Loss: 0.07981804013252258
Batch 个数 200, 当前Batch Loss: 0.10871350020170212
Batch 个数 250, 当前Batch Loss: 0.19323034584522247
Batch 个数 300, 当前Batch Loss: 0.34933924674987793
Batch 个数 350, 当前Batch Loss: 0.22931991517543793
Epoch [41/50], Loss: 0.1357
Batch 个数 0, 当前Batch Loss: 0.11479572206735611
Batch 个数 50, 当前Batch Loss: 0.07416126132011414
Batch 个数 100, 当前Batch Loss: 0.14734108746051788
Batch 个数 150, 当前Batch Loss: 0.09797035157680511
Batch 个数 200, 当前Batch Loss: 0.15927083790302277
Batch 个数 250, 当前Batch Loss: 0.047750238329172134
Batch 个数 300, 当前Batch Loss: 0.10977602005004883
Batch 个数 350, 当前Batch Loss: 0.09146612882614136
Epoch [42/50], Loss: 0.1283
Batch 个数 0, 当前Batch Loss: 0.18599408864974976
Batch 个数 50, 当前Batch Loss: 0.19341303408145905
Batch 个数 100, 当前Batch Loss: 0.12728941440582275
Batch 个数 150, 当前Batch Loss: 0.06640170514583588
Batch 个数 200, 当前Batch Loss: 0.08068365603685379
Batch 个数 250, 当前Batch Loss: 0.07580865174531937
Batch 个数 300, 当前Batch Loss: 0.20310360193252563
Batch 个数 350, 当前Batch Loss: 0.05896846950054169
Epoch [43/50], Loss: 0.1222
Batch 个数 0, 当前Batch Loss: 0.13019287586212158
Batch 个数 50, 当前Batch Loss: 0.04888294264674187
Batch 个数 100, 当前Batch Loss: 0.03402791544795036
Batch 个数 150, 当前Batch Loss: 0.24396494030952454
Batch 个数 200, 当前Batch Loss: 0.1913367658853531
Batch 个数 250, 当前Batch Loss: 0.043654993176460266
Batch 个数 300, 当前Batch Loss: 0.13489089906215668
Batch 个数 350, 当前Batch Loss: 0.14694654941558838
Epoch [44/50], Loss: 0.1167
Batch 个数 0, 当前Batch Loss: 0.055672537535429
Batch 个数 50, 当前Batch Loss: 0.1397266536951065
Batch 个数 100, 当前Batch Loss: 0.17494075000286102
Batch 个数 150, 当前Batch Loss: 0.19216811656951904
Batch 个数 200, 当前Batch Loss: 0.11687476933002472
Batch 个数 250, 当前Batch Loss: 0.17383457720279694
Batch 个数 300, 当前Batch Loss: 0.09677251428365707
Batch 个数 350, 当前Batch Loss: 0.07793693989515305
Epoch [45/50], Loss: 0.1133
Batch 个数 0, 当前Batch Loss: 0.06693731993436813
Batch 个数 50, 当前Batch Loss: 0.07561050355434418
Batch 个数 100, 当前Batch Loss: 0.2163154035806656
Batch 个数 150, 当前Batch Loss: 0.1371024250984192
Batch 个数 200, 当前Batch Loss: 0.04820188507437706
Batch 个数 250, 当前Batch Loss: 0.027533825486898422
Batch 个数 300, 当前Batch Loss: 0.12957331538200378
Batch 个数 350, 当前Batch Loss: 0.09148090332746506
Epoch [46/50], Loss: 0.1078
Batch 个数 0, 当前Batch Loss: 0.02813582867383957
Batch 个数 50, 当前Batch Loss: 0.07444794476032257
Batch 个数 100, 当前Batch Loss: 0.07851608842611313
Batch 个数 150, 当前Batch Loss: 0.09082497656345367
Batch 个数 200, 当前Batch Loss: 0.03506339341402054
Batch 个数 250, 当前Batch Loss: 0.05984488129615784
Batch 个数 300, 当前Batch Loss: 0.09329638630151749
Batch 个数 350, 当前Batch Loss: 0.13983255624771118
Epoch [47/50], Loss: 0.1027
Batch 个数 0, 当前Batch Loss: 0.1092456504702568
Batch 个数 50, 当前Batch Loss: 0.04797329753637314
Batch 个数 100, 当前Batch Loss: 0.036118216812610626
Batch 个数 150, 当前Batch Loss: 0.09702274203300476
Batch 个数 200, 当前Batch Loss: 0.11091554164886475
Batch 个数 250, 当前Batch Loss: 0.10299698263406754
Batch 个数 300, 当前Batch Loss: 0.07772243022918701
Batch 个数 350, 当前Batch Loss: 0.04868464171886444
Epoch [48/50], Loss: 0.0968
Batch 个数 0, 当前Batch Loss: 0.05393305793404579
Batch 个数 50, 当前Batch Loss: 0.0451708659529686
Batch 个数 100, 当前Batch Loss: 0.06368286907672882
Batch 个数 150, 当前Batch Loss: 0.05177582800388336
Batch 个数 200, 当前Batch Loss: 0.13793227076530457
Batch 个数 250, 当前Batch Loss: 0.15712907910346985
Batch 个数 300, 当前Batch Loss: 0.01179390586912632
Batch 个数 350, 当前Batch Loss: 0.19676603376865387
Epoch [49/50], Loss: 0.0929
Batch 个数 0, 当前Batch Loss: 0.04869812726974487
Batch 个数 50, 当前Batch Loss: 0.19413995742797852
Batch 个数 100, 当前Batch Loss: 0.08810622245073318
Batch 个数 150, 当前Batch Loss: 0.0444062277674675
Batch 个数 200, 当前Batch Loss: 0.08240892738103867
Batch 个数 250, 当前Batch Loss: 0.03698882460594177
Batch 个数 300, 当前Batch Loss: 0.04639463499188423
Batch 个数 350, 当前Batch Loss: 0.09723903983831406
Epoch [50/50], Loss: 0.0881
输入 '帮我导航到北京' 预测为: 'Travel-Query'
输入 '查询明天北京的天气' 预测为: 'Weather-Query'

"""

import pandas as pd
import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import Dataset, DataLoader

# ... (Data loading and preprocessing remains the same) ...
dataset = pd.read_csv("../../第1周：课程介绍与大模型基础/Week01/dataset.csv", sep="\t", header=None)
texts = dataset[0].tolist()
string_labels = dataset[1].tolist()

label_to_index = {label: i for i, label in enumerate(set(string_labels))}
numerical_labels = [label_to_index[label] for label in string_labels]

char_to_index = {'<pad>': 0}
for text in texts:
    for char in text:
        if char not in char_to_index:
            char_to_index[char] = len(char_to_index)

index_to_char = {i: char for char, i in char_to_index.items()}
vocab_size = len(char_to_index)

max_len = 40


class CharBoWDataset(Dataset):
    def __init__(self, texts, labels, char_to_index, max_len, vocab_size):
        self.texts = texts
        self.labels = torch.tensor(labels, dtype=torch.long)
        self.char_to_index = char_to_index
        self.max_len = max_len
        self.vocab_size = vocab_size
        self.bow_vectors = self._create_bow_vectors()

    def _create_bow_vectors(self):
        tokenized_texts = []
        for text in self.texts:
            tokenized = [self.char_to_index.get(char, 0) for char in text[:self.max_len]]
            tokenized += [0] * (self.max_len - len(tokenized))
            tokenized_texts.append(tokenized)

        bow_vectors = []
        for text_indices in tokenized_texts:
            bow_vector = torch.zeros(self.vocab_size)
            for index in text_indices:
                if index != 0:
                    bow_vector[index] += 1
            bow_vectors.append(bow_vector)
        return torch.stack(bow_vectors)

    def __len__(self):
        return len(self.texts)

    def __getitem__(self, idx):
        return self.bow_vectors[idx], self.labels[idx]


class SimpleClassifier(nn.Module):
    def __init__(self, input_dim, hidden_dim1, hidden_dim2, hidden_dim3, output_dim): # 层的个数 和 验证集精度
        # 层初始化
        super(SimpleClassifier, self).__init__()
        self.fc1 = nn.Linear(input_dim, hidden_dim1)
        self.relu = nn.ReLU()
        self.fc2 = nn.Linear(hidden_dim1, hidden_dim2)
        self.relu = nn.ReLU()
        self.fc3 = nn.Linear(hidden_dim2, hidden_dim3)
        self.relu = nn.ReLU()
        self.fc4 = nn.Linear(hidden_dim3, output_dim)

    def forward(self, x):
        # 手动实现每层的计算
        out = self.fc1(x)
        out = self.relu(out)
        out = self.fc2(out)
        out = self.relu(out)
        out = self.fc3(out)
        out = self.relu(out)
        out = self.fc4(out)
        return out


char_dataset = CharBoWDataset(texts, numerical_labels, char_to_index, max_len, vocab_size) # 读取单个样本
dataloader = DataLoader(char_dataset, batch_size=32, shuffle=True) # 读取批量数据集 -》 batch数据

# hidden_dim = 128
output_dim = len(label_to_index)
model = SimpleClassifier(vocab_size, 64, 64,64, output_dim) # 维度和精度有什么关系？
criterion = nn.CrossEntropyLoss() # 损失函数 内部自带激活函数，softmax
optimizer = optim.SGD(model.parameters(), lr=0.01)

# epoch： 将数据集整体迭代训练一次
# batch： 数据集汇总为一批训练一次

num_epochs = 50
for epoch in range(num_epochs): # 12000， batch size 100 -》 batch 个数： 12000 / 100
    model.train()
    running_loss = 0.0
    for idx, (inputs, labels) in enumerate(dataloader):
        optimizer.zero_grad()
        outputs = model(inputs)
        loss = criterion(outputs, labels)
        loss.backward()
        optimizer.step()
        running_loss += loss.item()
        if idx % 50 == 0:
            print(f"Batch 个数 {idx}, 当前Batch Loss: {loss.item()}")


    print(f"Epoch [{epoch + 1}/{num_epochs}], Loss: {running_loss / len(dataloader):.4f}")


def classify_text(text, model, char_to_index, vocab_size, max_len, index_to_label):
    tokenized = [char_to_index.get(char, 0) for char in text[:max_len]]
    tokenized += [0] * (max_len - len(tokenized))

    bow_vector = torch.zeros(vocab_size)
    for index in tokenized:
        if index != 0:
            bow_vector[index] += 1

    bow_vector = bow_vector.unsqueeze(0)

    model.eval()
    with torch.no_grad():
        output = model(bow_vector)

    _, predicted_index = torch.max(output, 1)
    predicted_index = predicted_index.item()
    predicted_label = index_to_label[predicted_index]

    return predicted_label


index_to_label = {i: label for label, i in label_to_index.items()}

new_text = "帮我导航到北京"
predicted_class = classify_text(new_text, model, char_to_index, vocab_size, max_len, index_to_label)
print(f"输入 '{new_text}' 预测为: '{predicted_class}'")

new_text_2 = "查询明天北京的天气"
predicted_class_2 = classify_text(new_text_2, model, char_to_index, vocab_size, max_len, index_to_label)
print(f"输入 '{new_text_2}' 预测为: '{predicted_class_2}'")
